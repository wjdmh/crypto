{
  "name": "Chronos: Agentic Narrative",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "40 8 * * 1-5"
            }
          ]
        }
      },
      "name": "Cron (08:40 AM)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        250,
        300
      ],
      "notesInFlow": true,
      "notes": "í‰ì¼ ì•„ì¹¨ 8ì‹œ 40ë¶„ ì‹¤í–‰"
    },
    {
      "parameters": {
        "url": "=https://openapi.naver.com/v1/search/news.json?query={{encodeURI('ì£¼ì‹ ê°•ë ¥ ë§¤ìˆ˜ OR í˜¸ì¬ OR ë‹¨ë…')}}&display=20&sort=date",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "name": "Fetch Market News (Naver)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        450,
        300
      ],
      "notesInFlow": true,
      "notes": "ë„¤ì´ë²„ ë‰´ìŠ¤ APIì—ì„œ ì¥ì „ ê°•ë ¥í•œ í˜¸ì¬ ë‰´ìŠ¤ ìˆ˜ì§‘"
    },
    {
      "parameters": {
        "functionCode": "const items = $input.all()[0].json.items || [];\nlet textBlock = \"[ì˜¤ëŠ˜ ì•„ì¹¨ 8ì‹œ 40ë¶„ ì‹œì¥ ì£¼ìš” ë‰´ìŠ¤]\\n\";\n\nitems.forEach(item => {\n  textBlock += `- ì œëª©: ${item.title.replace(/<[^>]*>?/gm, '')}\\n  ë‚´ìš©: ${item.description.replace(/<[^>]*>?/gm, '')}\\n`;\n});\n\nreturn [{ json: { newsText: textBlock } }];"
      },
      "name": "Format News Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        650,
        300
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.newsText }}",
        "messages": {
          "messageValues": [
            {
              "content": "ë„ˆëŠ” ëŒ€í•œë¯¼êµ­ ìµœê³ ì˜ ë‹¨íƒ€ í”„ë íŠ¸ë ˆì´ë”ì•¼. ì…ë ¥ëœ ì•„ì¹¨ 8ì‹œ 40ë¶„ ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ì½ê³ , ì˜¤ëŠ˜ ì‹œì´ˆê°€ì— ìˆ˜ê¸‰ì´ í­ë°œì ìœ¼ë¡œ ëª°ë ¤ì„œ ë‹¨ê¸° ê¸‰ë“±(ìƒí•œê°€ í˜¹ì€ +10% ì´ìƒ)ì„ ë§Œë“¤ì–´ë‚¼ **ì••ë„ì ì¸ í˜¸ì¬(Narrative)ê°€ ìˆëŠ” ì¢…ëª© ë”± 1~2ê°œ**ë§Œ ì¶”ì¶œí•´.\\n\\n[ì¡°ê±´]\\n1. ë‹¨ìˆœí•œ ì‹¤ì  ë°œí‘œë‚˜ ë»”í•œ ë‰´ìŠ¤ëŠ” ë¬´ì‹œí•  ê²ƒ.\\n2. 'ì •ë¶€ ì •ì±… ìˆ˜í˜œ', 'ë‹¨ë… ìˆ˜ì£¼', 'ë°”ì´ì˜¤ ì„ìƒ ì„±ê³µ', 'M&A' ë“± íŒŒê¸‰ë ¥ì´ í° í‚¤ì›Œë“œì— ê°€ì¤‘ì¹˜ë¥¼ ë‘˜ ê²ƒ.\\n3. ë§Œì•½ ì˜¤ëŠ˜ ë‹¹ì¥ ê¸‰ë“±í•  ë§Œí•œ í™•ì‹¤í•œ ì¢…ëª©ì´ ì•ˆ ë³´ì´ë©´ ë¬´ì¡°ê±´ 'ì¢…ëª© ì—†ìŒ'ì´ë¼ê³  ë‹µë³€í•  ê²ƒ. ì–µì§€ë¡œ ë½‘ì§€ ë§ˆ.\\n\\n[ì¶œë ¥ í¬ë§· (JSON í˜•ì‹ìœ¼ë¡œë§Œ ëŒ€ë‹µí•  ê²ƒ)]\\n{\\n  \"targets\": [\\n    {\\n      \"ì¢…ëª©ëª…\": \"ì‚¼ì„±ì „ì\",\\n      \"ì´ìœ  ìš”ì•½\": \"ë‹¨ë… í˜¸ì¬ ê¸°ì‚¬ ë°œìƒ\",\\n      \"ê°•ë„\": \"ìƒ\"\\n    }\\n  ],\\n  \"hasTarget\": true\\n}"
            }
          ]
        },
        "options": {
          "temperature": 0.2
        }
      },
      "name": "LLM: Narrative Evaluator",
      "type": "@n8n/n8n-nodes-langchain.advancedGoogleGeminiChatModel",
      "typeVersion": 1,
      "position": [
        850,
        300
      ],
      "notesInFlow": true,
      "notes": "ë‰´ìŠ¤ ê¸°ë°˜ ê°•ë ¥ í…Œë§ˆì£¼ í•„í„°ë§ (Gemini ëª¨ë¸)"
    },
    {
      "parameters": {
        "functionCode": "let rawContent = $input.all()[0].json.output || $input.all()[0].json.text || \"\";\n// í˜¹ì‹œ ë§ˆí¬ë‹¤ìš´ ë¸”ë¡ì´ ì„ì—¬ìˆìœ¼ë©´ ì œê±°\nrawContent = rawContent.replace(/```json/g, '').replace(/```/g, '').trim();\ntry {\n  const parsed = JSON.parse(rawContent);\n  return [{ json: parsed }];\n} catch (e) {\n  return [{ json: { hasTarget: false, error: e.message, raw: rawContent } }];\n}"
      },
      "name": "Parse JSON",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1050,
        300
      ],
      "notesInFlow": true,
      "notes": "LLM ê²°ê³¼ JSON íŒŒì‹±"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.hasTarget }}",
              "value2": true
            }
          ]
        }
      },
      "name": "Check Valid Targets",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1250,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const data = $json.targets || [];\nlet msg = `ğŸš¨ [Chronos: Agentic Narrative íƒ€ê²Ÿ í¬ì°©] ğŸš¨\\n\\nì˜¤ëŠ˜ ì‹œì´ˆê°€ ìˆ˜ê¸‰ í­ë°œ ì˜ˆìƒ ì¢…ëª©ì…ë‹ˆë‹¤.\\n`\n\ndata.forEach(t => {\n  msg += `\\nâ–ªï¸ ì¢…ëª©ëª…: ${t.ì¢…ëª©ëª…}\\nğŸ’¬ ë‚´ëŸ¬í‹°ë¸Œ: ${t['ì´ìœ  ìš”ì•½']}\\nğŸ”¥ ê°•ë„: ${t.ê°•ë„}\\n`;\n});\n\nmsg += `\\nâš ï¸ [ë§¤ë§¤ ì§€ì¹¨ (ìê¸ˆ 50ë§Œì›)]\\n1. 9ì‹œ ì •ê° ê°œì¥ í›„ ì¶”ê²© ë§¤ìˆ˜ ê¸ˆì§€\\n2. 9ì‹œ 5ë¶„ê¹Œì§€ì˜ VWAP(ê±°ë˜ëŸ‰ ê°€ì¤‘ í‰ê· ê°€) ì§€ì§€ ì—¬ë¶€ í™•ì¸ í›„ ì§„ì…\\n3. ì†ì ˆê°€: ì§„ì…ê°€ ëŒ€ë¹„ -2% (í˜¹ì€ ì´ì „ 5ë¶„ë´‰ì˜ ì €ê°€ ì´íƒˆ ì‹œ)\\n4. ìµì ˆê°€: ì§„ì…ê°€ ëŒ€ë¹„ +3% ~ +5% ì´ìƒ ììœ¨ ëŒ€ì‘`;\n\nreturn [{ json: { telegramMsg: msg } }];"
      },
      "name": "Format Telegram Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1450,
        150
      ]
    },
    {
      "parameters": {
        "chatId": "7839028905",
        "text": "={{ $json.telegramMsg }}",
        "additionalFields": {}
      },
      "name": "Send Telegram Alert",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.1,
      "position": [
        1650,
        150
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "Cron (08:40 AM)": {
      "main": [
        [
          {
            "node": "Fetch Market News (Naver)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Market News (Naver)": {
      "main": [
        [
          {
            "node": "Format News Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format News Data": {
      "main": [
        [
          {
            "node": "LLM: Narrative Evaluator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM: Narrative Evaluator": {
      "main": [
        [
          {
            "node": "Parse JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse JSON": {
      "main": [
        [
          {
            "node": "Check Valid Targets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Valid Targets": {
      "main": [
        [
          {
            "node": "Format Telegram Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Telegram Message": {
      "main": [
        [
          {
            "node": "Send Telegram Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {}
}